<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="components/loader.js"></script>
    <link rel="stylesheet" href="components/loader.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script type="text/javascript">
        //マップ関係
        var directionsService;
        var directionsDisplay;
        var map;
        var mapCenter;
        var mapCurrent;
        var distance;
        var distanceText;
        var durationText;

        var markerObjs = null;
        
        google.maps.event.addDomListener(window, 'load', function(){
            $("#map_canvas").empty();
        
            //マップ関係
            // var mapDiv = document.getElementById("map_canvas");
            var mapDiv = $("#map_canvas").get(0);
            
            // 位置情報取得オブジェクトチェック
            if (!navigator.geolocation){
                mapDiv.html("Geolocation 使用不可");
            }
             
            mapCenter = new google.maps.LatLng(34.971953, 138.388959);
    		var map_options = {
				zoom:16,                // 表示倍率
				center:mapCenter,       // 中央位置
				mapTypeId:google.maps.MapTypeId.ROADMAP,
				scaleControl:true       // 倍率変更
			};
			// 地図を表示
			map = new google.maps.Map(mapDiv, map_options);
            var marker_station = new google.maps.Marker({
        		position:mapCenter,
				map:map,
				title:"静岡駅",
			});
			map.setCenter(mapCenter);
            
            //追加したオブジェクトにイベントリスナを追加。
        	google.maps.event.addListener(marker_station, 'click', function() {
				var infoWindow = new google.maps.InfoWindow();
				
				infoWindow.setContent(marker_station.title);
				infoWindow.open(map, marker_station);
			});
            
            // 位置情報取得オブジェクトオプション
            var gps_option = {
                timeout:10000,            // タイムアウト
                enableHighAccuracy:true,   // GPS利用
                maximumAge: 0
            }
         
            // 位置情報を取得
            navigator.geolocation.getCurrentPosition(resultHandler, errorHandler, gps_option);
            
            function errorHandler(e){
                alert("GPS error." + "\n" + e.code + ":" + e.message);
        	}
        	
            function resultHandler(position){
				latitude = position.coords.latitude;
				longitude = position.coords.longitude;
				alert("latitude:" + latitude + "\n" + 
					"longitude:" + longitude);
            }
		});        
    </script>
</head>
<body>
    <div id="map_canvas"></div>
    <div id="result"></div>
</body>
</html>